service: backend

provider:
  name: aws
  runtime: ruby3.2
  stage: ${opt:stage, 'dev'} # 本番環境に切り替えること!(prodと入れること！)
  region: ap-northeast-1
  environment:
    # AWS_REGION: ${env:AWS_REGION}
    # AWS_ACCESS_KEY_ID: ${env:AWS_ACCESS_KEY_ID}
    # AWS_SECRET_ACCESS_KEY: ${env:AWS_SECRET_ACCESS_KEY}
    # BACKEND_AWS_S3_BUCKET: ${env:BACKEND_AWS_S3_BUCKET}
    RAILS_LOG_TO_STDOUT: true

package:
  include:
    - vendor/bundle/**

functions:
  app:
    handler: lambda_function.lambda_handler
    events:
      - http:
          path: /{proxy+}
          method: any
          cors:
            origin: '*' # ここを適切なオリジンに設定
            headers:
              - Content-Type
              - X-Amz-Date
              - Authorization
              - X-Api-Key
              - X-Amz-Security-Token
              - X-Amz-User-Agent
            allowCredentials: false
